import{r as v,a as E,u as n,b as T,c as U,A as f,d as u,e as k,f as M,s as y,g as S,o as O,h as b,w as A,_ as R,i as D,j,k as m,t as w,m as o,v as x,l as $,n as B,M as I,p as N,q as V}from"./index-D9k1Ji78.js";const L=[{label:"Numéro de proforma",field:"numero_proforma",status:null,color:null,bgColor:null},{label:"Titre",field:"titre",status:null,color:null,bgColor:null},{label:"Client",field:"client",status:null,color:null,bgColor:null},{label:"Montant TTC",field:"montant_ttc",status:null,color:null,bgColor:null},{label:"Statut",field:"status",status:null,color:null,bgColor:null},{label:"Date de création",field:"date_creation",status:null,color:null,bgColor:null},{label:"Date de validité",field:"date_validite",status:null,color:null,bgColor:null}],P=()=>{const{readData:C,createData:p,deleteData:i,updateData:g}=k(),{EmptyFields:d}=M(),s=v({loading:!1,loadingCreate:!1,loadingDelete:!1,loadingUpdate:!1}),F=E([]);F.value=n().Factures;const{toast:r}=T(),_=l=>l.map(t=>({id:t.id,libelle:t.libelle,date_creation:y(t.created_at).format("l")})),h=U(()=>n().Factures);return{FindFactureAll:()=>{s.loading=!0,C(f.FACTURE_LIST).then(l=>{n().Factures=_(l.datas),s.loading=!1}).catch(()=>{s.loading=!1})},FindFactureOne:()=>{},CreateFacture:async l=>(s.loadingCreate=!0,{data:await p(f.FACTURE_CREATE,l).then(e=>{if(e){d(l),s.loadingCreate=!1;let a=n().Factures;const c=_([e.data]);a.unshift(...c),n().Factures=a,u().open=!1,r({title:"Enregistré",description:e.message})}}).catch(e=>{if(s.loadingCreate=!1,e){const a=Object.keys(e.response.data.errors);r(a?{title:a[0],variant:"destructive",description:e.response.data.errors[a[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})}),FactureUpdate:(l,t)=>{s.loadingCreate=!0,g(f.FACTURE_UPDATE+"/"+l,t).then(e=>{if(e){d(t),s.loadingCreate=!1;let a=n().Factures;const c=_([e.data]);a.unshift(...c),n().Factures=a,u().open=!1,r({title:"Enregistré",description:e.message})}}).catch(e=>{if(s.loadingCreate=!1,e){const a=Object.keys(e.response.data.errors);r(a?{title:a[0],variant:"destructive",description:e.response.data.errors[a[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})},FactureDelete:l=>{s.loadingDelete=!0,i(f.FACTURE_REMOVE+"/"+l).then(t=>{if(t){s.loadingDelete=!1;let e=n().Factures;const a=e.filter(c=>c.id!=l);e.unshift(...a),n().Factures=e,u().open=!1,u().delete=!1,r({title:"Supprimer",description:t.message})}}).catch(t=>{if(s.loadingDelete=!1,u().delete=!1,t){const e=Object.keys(t.response.data.errors);r(e?{title:e[0],variant:"destructive",description:t.response.data.errors[e[0]][0]}:{title:"error",variant:"destructive",description:t.response.data.message})}})},stateFactures:F,setFacture:s,storeFactures:h}},H={class:"flex flex-col w-full gap-4 bg-white rounded-lg mb-8"},W=S({__name:"facture_compta.page",setup(C){const{FindFactureAll:p,storeFactures:i,FactureDelete:g,setFacture:d}=P();return O(()=>{p()}),(s,F)=>(D(),b(R,null,{content:A(()=>[j("section",H,[m($,{title:"COMPTABILITES | Factures"},{created:A(()=>[m(w,{name:"Ajouter un categorie",title:"Ajouter un nouvel categorie",funDelete:o(g),id:o(x)().isDelete.id},null,8,["funDelete","id"])]),_:1}),o(i).length!=0?(D(),b(B,{key:0,dataTables:o(i),MenuActions:o(I),display:o(L)},null,8,["dataTables","MenuActions","display"])):N("",!0),m(V,{loading:o(d).loading,data:o(i),name:"Aucune factures"},null,8,["loading","data"])])]),_:1}))}});export{W as default};
