import{l as z,d as m,x as Q,a as d,c as _,w as t,m as h,n as H,p as J,u as e,t as te,q as ae,s as B,v as V,e as a,y as le,z as P,A as y,B as oe,C as ne,D as K,E as re,F as ie,G as de,b as r,H as ce,I as ue,J as pe,K as fe,L as _e,N as me,O as ve,P as N,Q as S,o as he,_ as ge,R as q,S as ye,T as be,U as xe,h as we,V as x,W as A,X as $e,Y as R,Z as D,$ as C,a0 as Le,a1 as Se,a2 as Ce,a3 as Be,a4 as G,a5 as T,a6 as Pe,a7 as U,a8 as ke,a9 as Oe,aa as qe,ab as M}from"./index-CqCMLplJ.js";import{u as De}from"./livraison.hook-DH7XuFG2.js";/**
 * @license lucide-vue-next v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=z("CheckIcon",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=z("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=z("ChevronUpIcon",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Re=m({__name:"Select",props:{open:{type:Boolean},defaultOpen:{type:Boolean},defaultValue:{},modelValue:{},dir:{},name:{},autocomplete:{},disabled:{type:Boolean},required:{type:Boolean}},emits:["update:modelValue","update:open"],setup(c,{emit:o}){const n=Q(c,o);return(u,g)=>(d(),_(e(te),H(J(e(n))),{default:t(()=>[h(u.$slots,"default")]),_:3},16))}}),Ve=m({__name:"SelectValue",props:{placeholder:{},asChild:{type:Boolean},as:{}},setup(c){const o=c;return(i,f)=>(d(),_(e(ae),H(J(o)),{default:t(()=>[h(i.$slots,"default")]),_:3},16))}}),Te=m({__name:"SelectTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(c){const o=c,i=B(()=>{const{class:n,...u}=o;return u}),f=V(i);return(n,u)=>(d(),_(e(oe),P(e(f),{class:e(y)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",o.class)}),{default:t(()=>[h(n.$slots,"default"),a(e(le),{"as-child":""},{default:t(()=>[a(e(W),{class:"w-4 h-4 opacity-50"})]),_:1})]),_:3},16,["class"]))}}),Ue=m({inheritAttrs:!1,__name:"SelectContent",props:{forceMount:{type:Boolean},position:{default:"popper"},bodyLock:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["closeAutoFocus","escapeKeyDown","pointerDownOutside"],setup(c,{emit:o}){const i=c,f=o,n=B(()=>{const{class:g,...b}=i;return b}),u=Q(n,f);return(g,b)=>(d(),_(e(ie),null,{default:t(()=>[a(e(re),P({...e(u),...g.$attrs},{class:e(y)("relative z-50 max-h-96 min-w-32 overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",g.position==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",i.class)}),{default:t(()=>[a(e(Fe)),a(e(ne),{class:K(e(y)("p-1",g.position==="popper"&&"h-[--radix-select-trigger-height] w-full min-w-[--radix-select-trigger-width]"))},{default:t(()=>[h(g.$slots,"default")]),_:3},8,["class"]),a(e(Ne))]),_:3},16,["class"])]),_:3}))}}),Me=m({__name:"SelectGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(c){const o=c,i=B(()=>{const{class:f,...n}=o;return n});return(f,n)=>(d(),_(e(de),P({class:e(y)("p-1 w-full",o.class)},i.value),{default:t(()=>[h(f.$slots,"default")]),_:3},16,["class"]))}}),ze={class:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"},Ee=m({__name:"SelectItem",props:{value:{},disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(c){const o=c,i=B(()=>{const{class:n,...u}=o;return u}),f=V(i);return(n,u)=>(d(),_(e(pe),P(e(f),{class:e(y)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",o.class)}),{default:t(()=>[r("span",ze,[a(e(ce),null,{default:t(()=>[a(e(Ie),{class:"h-4 w-4"})]),_:1})]),a(e(ue),null,{default:t(()=>[h(n.$slots,"default")]),_:3})]),_:3},16,["class"]))}}),je=m({__name:"SelectLabel",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(c){const o=c;return(i,f)=>(d(),_(e(fe),{class:K(e(y)("py-1.5 pl-8 pr-2 text-sm font-semibold",o.class))},{default:t(()=>[h(i.$slots,"default")]),_:3},8,["class"]))}}),Fe=m({__name:"SelectScrollUpButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(c){const o=c,i=B(()=>{const{class:n,...u}=o;return u}),f=V(i);return(n,u)=>(d(),_(e(_e),P(e(f),{class:e(y)("flex cursor-default items-center justify-center py-1",o.class)}),{default:t(()=>[h(n.$slots,"default",{},()=>[a(e(Ae),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Ne=m({__name:"SelectScrollDownButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(c){const o=c,i=B(()=>{const{class:n,...u}=o;return u}),f=V(i);return(n,u)=>(d(),_(e(me),P(e(f),{class:e(y)("flex cursor-default items-center justify-center py-1",o.class)}),{default:t(()=>[h(n.$slots,"default",{},()=>[a(e(W),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Ge=[{label:"Site Livraison",type:"text",placeholder:"Libelle",name:"site_livraison",value:"",select:[]},{label:"Date depart",type:"date",placeholder:"Date depart",name:"date_depart",value:"",select:[]},{label:"Date retour",type:"date",placeholder:"Ex: Unil",name:"date_retour",value:"",select:[]},{label:"Moyen Livraison",type:"text",placeholder:"Moyen Livraison",name:"moyen_livraison",value:"",select:[]},{label:"Agent Livraison",type:"text",placeholder:"Agent Livraison",name:"agent_livraison",value:"",select:[]},{label:"Chaffeur",type:"text",placeholder:"Ex: Unil",name:"chaffeur",value:"",select:[]}],Qe={class:"flex flex-col w-full gap-4 bg-white rounded-lg mb-4"},He={class:"w-11/12 m-auto flex gap-4 items-start pb-8 flex-col"},Je={class:"w-full grid grid-cols-2 gap-2"},Ke={class:""},We={class:"w-full bg-white rounded-md space-y-4"},Xe={class:"flex w-full flex-col lg:flex-row gap-4"},Ye={class:"bg-white rounded-md flex flex-col gap-2 w-full"},Ze=r("div",{class:"bg-gray-200 rounded-t-md p-3"},[r("span",{class:"text-base font-bold"}," Ajouter des produits ou services ")],-1),es={class:"gap-2 pb-2"},ss={class:"w-full"},ts={class:"flex flex-col w-full gap-3"},as=["value"],ls={class:"flex flex-col"},os=r("label",{for:"",class:"text-sm flex gap-1"},"Quantité",-1),ns={class:"flex w-full m-auto"},rs=r("span",{class:""},null,-1),is={class:""},ds={class:"flex flex-col gap-2"},cs=["onClick"],us={class:"flex justify-between w-full"},ps=r("span",{class:""},null,-1),fs=["disabled"],_s={key:1,class:""},hs=m({__name:"livraison_add_logic.page",setup(c){const{toast:o}=ve(),{readData:i,showData:f}=ye(),n=N({loading:!1}),u=S(),g=S([]),b=S([]),k=S([]),w=N({id:"",quantite:"",reference:"",produit_service_id:"",quantite_livree:""}),O=S(!1),E=be(),$=xe(),X=()=>{n.loading=!0,i(q.PRODUCT_LIST).then(s=>{g.value=s.datas,n.loading=!1}).catch(()=>{n.loading=!1}),i(q.PROFORMA_LIST).then(s=>{u.value=s.datas,n.loading=!1}).catch(()=>{n.loading=!1})},Y=s=>{var p,l;console.log(s),k.value.push({reference:s.reference,id:(p=b.value.find(v=>v.reference==s.reference))==null?void 0:p.id,produit_service_id:(l=b.value.find(v=>v.reference==s.reference))==null?void 0:l.id,quantite:s.quantite,quantite_livree:s.quantite})},Z=s=>{k.value=k.value.filter(p=>p.id!==s)},j=S(),ee=s=>{console.log(s.target.value),j.value=s.target.value,f(q.PRODUCT_PROFORMA_LIST,s.target.value).then(p=>{b.value=p.datas,n.loading=!1}).catch(()=>{n.loading=!1})},{formatLivraisonData:F}=De(),se=async()=>{try{O.value=!0;const s=v=>{const L=document.querySelector(`#${v}`);return L==null?void 0:L.value},p={livraisonId:j.value,produits_livres:JSON.stringify(k.value),site_livraison:s("site_livraison"),date_depart:s("date_depart"),date_retour:s("date_retour"),moyen_livraison:s("date_retour"),agent_livraison:s("date_retour"),chauffeur:s("chaffeur")},{data:l}=await qe.post($.query.id?`${q.PROFORMA_UPDATE}/${$.query.id}`:`${q.LIVRAISON_CREATE}`,p);if(l){const v=l;if(O.value=!1,o({title:"Livraisons",description:v.message}),!$.query.id)M().Livraisons.unshift(...F([l.data])),E.push({name:"LOGISC_LIVRAISONS"});else{const L=M().Livraisons.map(I=>(console.log(I.id==$.query.id),I.id==$.query.id&&(I=F([l.data])),{...I}));M().Livraisons=L,E.push({name:"LOGISC_LIVRAISONS"})}}}catch(s){if(O.value=!1,s!=null&&s.errors)o({title:s.errors[0].path[0],variant:"destructive",description:s.errors[0].message});else{const p=Object.keys(s.response.data.errors);o({title:p[0],variant:"destructive",description:s.response.data.errors[p[0]][0]})}}};return he(()=>{X()}),(s,p)=>(d(),_(ge,null,{content:t(()=>[r("section",Qe,[a(we,{title:`Logistique | ${s.$route.query.id?"Modification Livraion":"Création Livraion"}`},{created:t(()=>[]),_:1},8,["title"]),r("div",He,[r("div",Je,[(d(!0),x(R,null,A(e(Ge),l=>(d(),x("div",Ke,[a($e,{title:l.label,name:l.name,label:l.label,type:l.type,placeholder:l.placeholder,select:l.select},null,8,["title","name","label","type","placeholder","select"])]))),256))]),r("div",We,[r("div",Xe,[r("div",Ye,[Ze,r("div",es,[r("div",ss,[r("div",ts,[r("select",{name:"",id:"",onInput:ee,class:"p-2 border-[1px] rounded-md"},[(d(!0),x(R,null,A(u.value,l=>(d(),x("option",{value:l.id},D(l.numero_proforma),9,as))),256))],32),a(e(Re),{class:"flex flex-col",modelValue:w.reference,"onUpdate:modelValue":p[0]||(p[0]=l=>w.reference=l)},{default:t(()=>[a(e(Te),null,{default:t(()=>[a(e(Ve),{placeholder:"Chossisez le product"})]),_:1}),a(e(Ue),null,{default:t(()=>[a(e(Me),null,{default:t(()=>[a(e(je)),(d(!0),x(R,null,A(b.value,l=>(d(),_(e(Ee),{value:l.reference},{default:t(()=>[C(D(l.reference),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1})]),_:1},8,["modelValue"]),r("div",ls,[os,Le(r("input",{type:"text","onUpdate:modelValue":p[1]||(p[1]=l=>w.quantite=l),placeholder:"Ex : 500",class:"border-[1px] w-full rounded-md py-2 px-4"},null,512),[[Se,w.quantite]])])])])]),r("div",ns,[rs,a(Ce,{disabled:w.quantite=="",onClick:p[2]||(p[2]=l=>Y(w)),class:"bg-gray-800 text-white px-3 text-sm font-bold py-2 rounded-md"},{default:t(()=>[C(" Ajouter ")]),_:1},8,["disabled"])])]),a(e(ke),{class:"bg-orange-50/50 w-full"},{default:t(()=>[a(e(Be),{class:"bg-gray-800"},{default:t(()=>[a(e(G),null,{default:t(()=>[a(e(T),null,{default:t(()=>[C("Reference")]),_:1}),a(e(T),null,{default:t(()=>[C("Quantités")]),_:1}),a(e(T),{class:""},{default:t(()=>[C(" Actions ")]),_:1})]),_:1})]),_:1}),a(e(Pe),null,{default:t(()=>[(d(!0),x(R,null,A(k.value,(l,v)=>(d(),_(e(G),{key:v},{default:t(()=>[a(e(U),null,{default:t(()=>[r("div",is,[r("span",ds,D(l.reference),1)])]),_:2},1024),a(e(U),{class:"font-medium"},{default:t(()=>[C(D(l.quantite),1)]),_:2},1024),a(e(U),{class:"text-right"},{default:t(()=>[r("i",{class:"ri-close-fill cursor-pointer",onClick:L=>Z(l.id)},null,8,cs)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),r("div",us,[ps,r("button",{onClick:se,class:"bg-gray-800 px-4 py-2 font-bold text-white rounded-md",disabled:O.value},[O.value?(d(),_(Oe,{key:0,size:"w-6 h-6"})):(d(),x("span",_s,D(e($).query.id?"Modification une livraison":"Créer une livraison"),1))],8,fs)])])])])]),_:1}))}});export{hs as default};
