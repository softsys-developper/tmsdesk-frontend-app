import{P as y,Q as E,ab as o,O as N,s as S,R as p,ah as D,ad as u,S as x,ai as U,ac as k,d as I,o as M,c as C,w as f,_ as O,a as A,b as B,e as g,h as R,u as i,i as v,an as w,j as $,k as P}from"./index-CxeJbbkP.js";import{a as Q}from"./compte.tables-Cp2-EN0C.js";const j=()=>{const{readData:m,createData:d}=x(),{EmptyFields:r}=U(),n=y({loading:!1,loadingCreate:!1}),_=E([]);_.value=o().Compte_transactions;const{toast:c}=N(),T=S(()=>o().Compte_transactions),h=a=>{let e;const t=[];return Object.keys(a).forEach(s=>{s.includes("paiement_")&&t.push(s),a[s]!=null&&(e=s.split("-").length!=1?s.split("-")[1]:s.split("-")[0])}),e},l=a=>a.map(e=>{var t;return{id:e.id,banque:(t=e.banque)==null?void 0:t.nom,montant:e.montant,type_transaction:`<p class="' py-1  capitalize max-w-min rounded-md px-4 flex justify-center font-bold text-xs text-white ' ${e.type_transaction!=="entree"?"bg-red-500":"bg-green-500"}">${e.type_transaction}</p>`,type_paiement:h(e),date_creation:k(e.created_at).format("DD/MM/YYYY")}});return{FindCompte_transactionAll:()=>{n.loading=!0,m(p.BANQUE_TRANSACTION_LIST).then(a=>{o().Compte_transactions=l(a.datas),n.loading=!1}).catch(()=>{n.loading=!1})},CreateCompte_transaction:async a=>(n.loadingCreate=!0,{data:await d(p.BANQUE_TRANSACTION_CREATE,a).then(t=>{if(t){r(a),n.loadingCreate=!1;let s=o().Compte_transactions;const b=l([t.data]);s.unshift(...b),o().Compte_transactions=s,D().open=!1,c({title:"EnregistrÃ©",description:t.message})}}).catch(t=>{if(n.loadingCreate=!1,console.log(t),t){const s=Object.keys(t.response.data.errors);c(s?{title:s[0],variant:"destructive",description:t.response.data.errors[s[0]][0]}:{title:"Erreur",variant:"destructive",description:t.response.data.message})}})}),Compte_transactionUpdate:(a,e)=>{u(n,o(),"Compte_transactions",l).SetUpdate(p.BANQUE_TRANSACTION_UPDATE,a,e)},Compte_transactionDelete:a=>{u(n,o(),"Compte_transactions",l).SetDelete(p.BANQUE_TRANSACTION_REMOVE,a)},stateCompte_transactions:_,setCompte_transaction:n,storeCompte_transactions:T}},F={class:"flex flex-col w-full gap-4 bg-white rounded-lg mb-8"},G=I({__name:"compte_transaction_compta.page",setup(m){const{FindCompte_transactionAll:d,storeCompte_transactions:r,setCompte_transaction:n}=j();return M(()=>{d()}),(_,c)=>(A(),C(O,null,{content:f(()=>[B("section",F,[g(R,{title:"COMPTABILITES | Transactions bancaire"},{created:f(()=>[]),_:1}),i(r).length!=0?(A(),C(v,{key:0,dataTables:i(r),MenuActions:i(w),display:i(Q)},null,8,["dataTables","MenuActions","display"])):$("",!0),g(P,{loading:i(n).loading,data:i(r),name:"Aucune Compte_transactions"},null,8,["loading","data"])])]),_:1}))}});export{G as default};
