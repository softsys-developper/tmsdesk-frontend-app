import{P as $,Q as w,aa as o,O as I,s as N,a8 as p,ak as b,ab as U,ac as k,ad as O,d as x,o as S,a as C,c as v,w as A,b as M,T as E,U as R,V as j,u as r,e as m,W as B,al as L,g as D,_ as V,f as T,h as H,am as Y,i as Q,j as q,k as G}from"./index-BIy4P4aR.js";import{u as W,F as y}from"./facture_paid.forms-Czx9S6cI.js";const z=[{label:"ID",field:"id",status:null,color:null,bgColor:null},{label:"Numéro de facture",field:"numero_facture",status:null,color:null,bgColor:null},{label:"Montant TTC",field:"montant_ttc",status:null,color:null,bgColor:null},{label:"Reste à payer",field:"reste_a_payer",status:null,color:null,bgColor:null},{label:"Statut",field:"status",status:null,color:null,bgColor:null},{label:"Date de création",field:"date_emission",status:null,color:null,bgColor:null}],J=()=>{const{readData:h,createData:_,deleteData:u,updateData:f}=U(),{EmptyFields:d}=k(),a=$({loading:!1,loadingCreate:!1,loadingDelete:!1,loadingUpdate:!1}),F=w([]);F.value=o().Factures;const{toast:s}=I(),i=(l,t)=>`<span class="flex  text-center text-sm font-bold max-w-max px-2 py-1 rounded-md justify-center text-white ${t}" >${l}</span>`,c=l=>l.map(t=>({id:t.id,numero_facture:t.numero_facture,montant_ttc:new Intl.NumberFormat("de-DE",{style:"currency",currency:"GNF"}).format(t.montant_ttc),reste_a_payer:t.reste_a_payer,status:t.statut==1?i("En attante","bg-orange-500"):t.statut==2?i("Partiellement","bg-blue-500"):i("Payer","bg-green-500"),date_emission:t.date_emission,date_creation:O(t.created_at).format("DD/MM/YYYY")})),P=N(()=>o().Factures);return{FindFactureAll:()=>{a.loading=!0,h(p.FACTURE_LIST).then(l=>{o().Factures=c(l.datas),a.loading=!1}).catch(()=>{a.loading=!1})},FindFactureOne:()=>{},CreateFacture:async l=>(a.loadingCreate=!0,{data:await _(p.FACTURE_CREATE,l).then(e=>{if(e){d(l),a.loadingCreate=!1;let n=o().Factures;const g=c([e.data]);n.unshift(...g),o().Factures=n,b().open=!1,s({title:"Enregistré",description:e.message})}}).catch(e=>{if(a.loadingCreate=!1,e){const n=Object.keys(e.response.data.errors);s(n?{title:n[0],variant:"destructive",description:e.response.data.errors[n[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})}),FactureUpdate:(l,t)=>{a.loadingCreate=!0,f(p.FACTURE_UPDATE+"/"+l,t).then(e=>{if(e){d(t),a.loadingCreate=!1;let n=o().Factures;const g=c([e.data]);n.unshift(...g),o().Factures=n,b().open=!1,s({title:"Enregistré",description:e.message})}}).catch(e=>{if(a.loadingCreate=!1,e){const n=Object.keys(e.response.data.errors);s(n?{title:n[0],variant:"destructive",description:e.response.data.errors[n[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})},FactureDelete:l=>{a.loadingDelete=!0,u(p.FACTURE_REMOVE+"/"+l).then(t=>{if(t){a.loadingDelete=!1;let e=o().Factures;const n=e.filter(g=>g.id!=l);e.unshift(...n),o().Factures=e,b().open=!1,b().delete=!1,s({title:"Supprimer",description:t.message})}}).catch(t=>{if(a.loadingDelete=!1,b().delete=!1,t){const e=Object.keys(t.response.data.errors);s(e?{title:e[0],variant:"destructive",description:t.response.data.errors[e[0]][0]}:{title:"error",variant:"destructive",description:t.response.data.message})}})},stateFactures:F,setFacture:a,storeFactures:P}},K={class:"w-full space-y-2"},X={class:""},Z=x({__name:"facture_paid.modal",setup(h){const{CreateFacturePaid:_,FacturePaidUpdate:u,setFacturePaid:f}=W(),{remplacerObjetDansTableau:d}=k(),{readData:a}=U(),F=s=>{let i=new FormData(s.target);D().isUpdate.is?u(D().isUpdate.id,i):_(i)};return S(()=>{o().Factures&&(a(p.BANQUE_LIST).then(s=>{o().Comptes=s.datas,d(y,"name","banque",s.datas)}),a(p.FACTURE_LIST).then(s=>{d(y,"name","factureId",s.datas.map(i=>({id:i.id,name:i.numero_facture})))}))}),(s,i)=>(C(),v(L,{Func:F,loading:r(f).loadingCreate,permissions:"payer-facture-client"},{form:A(()=>[M("div",K,[(C(!0),E(R,null,j(r(y),c=>(C(),E("div",X,[m(B,{title:c.label,name:c.name,label:c.label,type:c.type,placeholder:c.placeholder,select:c.select},null,8,["title","name","label","type","placeholder","select"])]))),256))])]),_:1},8,["loading"]))}}),ee={class:"flex flex-col w-full gap-4 bg-white rounded-lg mb-8"},ie=x({__name:"facture_compta.page",setup(h){const{FindFactureAll:_,storeFactures:u,FactureDelete:f,setFacture:d}=J();return S(()=>{_()}),(a,F)=>(C(),v(G,null,{content:A(()=>[M("section",ee,[m(V,{title:"COMPTABILITES | Factures"},{created:A(()=>[m(Z,{name:"Nouveau versement",title:r(D)().isUpdate.is?"Modifier le versement":"Nouveau versement"},null,8,["title"]),m(T,{funDelete:r(f),id:r(D)().isDelete.id},null,8,["funDelete","id"]),m(T,{funDelete:r(f),id:r(D)().isDelete.id},null,8,["funDelete","id"])]),_:1}),r(u).length!=0?(C(),v(H,{key:0,dataTables:r(u),MenuActions:r(Y),display:r(z)},null,8,["dataTables","MenuActions","display"])):Q("",!0),m(q,{loading:r(d).loading,data:r(u),name:"Aucune factures"},null,8,["loading","data"])])]),_:1}))}});export{ie as default};
