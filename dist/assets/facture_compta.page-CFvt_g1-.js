import{r as v,a as T,u as o,b as M,c as U,A as f,d as u,e as k,f as x,s as y,g as S,o as R,h as D,w as A,_ as j,i as h,j as O,k as C,t as $,m as l,v as w,l as I,n as V,M as B,p as N,q as Y}from"./index-DUkKG2oe.js";const H=[{label:"ID",field:"id",status:null,color:null,bgColor:null},{label:"Numéro de proforma",field:"numero_facture",status:null,color:null,bgColor:null},{label:"Montant TTC",field:"montant_ttc",status:null,color:null,bgColor:null},{label:"Statut",field:"status",status:null,color:null,bgColor:null},{label:"Date de création",field:"date_emission",status:null,color:null,bgColor:null}],L=()=>{const{readData:b,createData:p,deleteData:i,updateData:m}=k(),{EmptyFields:d}=x(),s=v({loading:!1,loadingCreate:!1,loadingDelete:!1,loadingUpdate:!1}),g=T([]);g.value=o().Factures;const{toast:r}=M(),_=(n,t)=>`<span class="text-sm font-bold min-w-max px-2 py-1 rounded-md text-center ${t}" >${n}</span>`,F=n=>n.map(t=>({id:t.id,numero_facture:t.numero_facture,montant_ttc:t.montant_ttc,status:t.etat==1?_("En attante","bg-orange-500"):t.etat==2?_("Valider","bg-blue-500"):_("Rejeter","bg-red-500"),date_emission:t.date_emission,date_creation:y(t.created_at).format("DD/MM/YYYY")})),E=U(()=>o().Factures);return{FindFactureAll:()=>{s.loading=!0,b(f.FACTURE_LIST).then(n=>{o().Factures=F(n.datas),s.loading=!1}).catch(()=>{s.loading=!1})},FindFactureOne:()=>{},CreateFacture:async n=>(s.loadingCreate=!0,{data:await p(f.FACTURE_CREATE,n).then(e=>{if(e){d(n),s.loadingCreate=!1;let a=o().Factures;const c=F([e.data]);a.unshift(...c),o().Factures=a,u().open=!1,r({title:"Enregistré",description:e.message})}}).catch(e=>{if(s.loadingCreate=!1,e){const a=Object.keys(e.response.data.errors);r(a?{title:a[0],variant:"destructive",description:e.response.data.errors[a[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})}),FactureUpdate:(n,t)=>{s.loadingCreate=!0,m(f.FACTURE_UPDATE+"/"+n,t).then(e=>{if(e){d(t),s.loadingCreate=!1;let a=o().Factures;const c=F([e.data]);a.unshift(...c),o().Factures=a,u().open=!1,r({title:"Enregistré",description:e.message})}}).catch(e=>{if(s.loadingCreate=!1,e){const a=Object.keys(e.response.data.errors);r(a?{title:a[0],variant:"destructive",description:e.response.data.errors[a[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})},FactureDelete:n=>{s.loadingDelete=!0,i(f.FACTURE_REMOVE+"/"+n).then(t=>{if(t){s.loadingDelete=!1;let e=o().Factures;const a=e.filter(c=>c.id!=n);e.unshift(...a),o().Factures=e,u().open=!1,u().delete=!1,r({title:"Supprimer",description:t.message})}}).catch(t=>{if(s.loadingDelete=!1,u().delete=!1,t){const e=Object.keys(t.response.data.errors);r(e?{title:e[0],variant:"destructive",description:t.response.data.errors[e[0]][0]}:{title:"error",variant:"destructive",description:t.response.data.message})}})},stateFactures:g,setFacture:s,storeFactures:E}},P={class:"flex flex-col w-full gap-4 bg-white rounded-lg mb-8"},W=S({__name:"facture_compta.page",setup(b){const{FindFactureAll:p,storeFactures:i,FactureDelete:m,setFacture:d}=L();return R(()=>{p()}),(s,g)=>(h(),D(j,null,{content:A(()=>[O("section",P,[C(I,{title:"COMPTABILITES | Factures"},{created:A(()=>[C($,{name:"Ajouter un categorie",title:"Ajouter un nouvel categorie",funDelete:l(m),id:l(w)().isDelete.id},null,8,["funDelete","id"])]),_:1}),l(i).length!=0?(h(),D(V,{key:0,dataTables:l(i),MenuActions:l(B),display:l(H)},null,8,["dataTables","MenuActions","display"])):N("",!0),C(Y,{loading:l(d).loading,data:l(i),name:"Aucune factures"},null,8,["loading","data"])])]),_:1}))}});export{W as default};
