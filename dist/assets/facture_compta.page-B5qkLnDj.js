import{P as y,Q as x,aa as o,O as U,s as k,a8 as p,ak as u,ab as M,ac as S,ad as w,d as O,o as $,a as A,c as h,w as v,b as N,e as d,_ as R,u as r,g as D,f as E,h as I,al as P,i as j,j as B,k as V}from"./index-D4Bvn5yU.js";import{_ as Y}from"./facture_paid.modal.vue_vue_type_script_setup_true_lang-krUOzT_k.js";const H=[{label:"ID",field:"id",status:null,color:null,bgColor:null},{label:"Numéro de facture",field:"numero_facture",status:null,color:null,bgColor:null},{label:"Montant TTC",field:"montant_ttc",status:null,color:null,bgColor:null},{label:"Statut",field:"status",status:null,color:null,bgColor:null},{label:"Date de création",field:"date_emission",status:null,color:null,bgColor:null}],L=()=>{const{readData:b,createData:g,deleteData:i,updateData:f}=M(),{EmptyFields:m}=S(),s=y({loading:!1,loadingCreate:!1,loadingDelete:!1,loadingUpdate:!1}),_=x([]);_.value=o().Factures;const{toast:l}=U(),F=(n,t)=>`<span class="flex  text-center text-sm font-bold max-w-max px-2 py-1 rounded-md justify-center text-white ${t}" >${n}</span>`,C=n=>n.map(t=>({id:t.id,numero_facture:t.numero_facture,montant_ttc:new Intl.NumberFormat("de-DE",{style:"currency",currency:"CFA"}).format(t.montant_ttc),status:t.statut==1?F("En attante","bg-orange-500"):t.statut==2?F("Partiellement","bg-blue-500"):F("Payer","bg-green-500"),date_emission:t.date_emission,date_creation:w(t.created_at).format("DD/MM/YYYY")})),T=k(()=>o().Factures);return{FindFactureAll:()=>{s.loading=!0,b(p.FACTURE_LIST).then(n=>{o().Factures=C(n.datas),s.loading=!1}).catch(()=>{s.loading=!1})},FindFactureOne:()=>{},CreateFacture:async n=>(s.loadingCreate=!0,{data:await g(p.FACTURE_CREATE,n).then(e=>{if(e){m(n),s.loadingCreate=!1;let a=o().Factures;const c=C([e.data]);a.unshift(...c),o().Factures=a,u().open=!1,l({title:"Enregistré",description:e.message})}}).catch(e=>{if(s.loadingCreate=!1,e){const a=Object.keys(e.response.data.errors);l(a?{title:a[0],variant:"destructive",description:e.response.data.errors[a[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})}),FactureUpdate:(n,t)=>{s.loadingCreate=!0,f(p.FACTURE_UPDATE+"/"+n,t).then(e=>{if(e){m(t),s.loadingCreate=!1;let a=o().Factures;const c=C([e.data]);a.unshift(...c),o().Factures=a,u().open=!1,l({title:"Enregistré",description:e.message})}}).catch(e=>{if(s.loadingCreate=!1,e){const a=Object.keys(e.response.data.errors);l(a?{title:a[0],variant:"destructive",description:e.response.data.errors[a[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})},FactureDelete:n=>{s.loadingDelete=!0,i(p.FACTURE_REMOVE+"/"+n).then(t=>{if(t){s.loadingDelete=!1;let e=o().Factures;const a=e.filter(c=>c.id!=n);e.unshift(...a),o().Factures=e,u().open=!1,u().delete=!1,l({title:"Supprimer",description:t.message})}}).catch(t=>{if(s.loadingDelete=!1,u().delete=!1,t){const e=Object.keys(t.response.data.errors);l(e?{title:e[0],variant:"destructive",description:t.response.data.errors[e[0]][0]}:{title:"error",variant:"destructive",description:t.response.data.message})}})},stateFactures:_,setFacture:s,storeFactures:T}},Q={class:"flex flex-col w-full gap-4 bg-white rounded-lg mb-8"},Z=O({__name:"facture_compta.page",setup(b){const{FindFactureAll:g,storeFactures:i,FactureDelete:f,setFacture:m}=L();return $(()=>{g()}),(s,_)=>(A(),h(V,null,{content:v(()=>[N("section",Q,[d(R,{title:"COMPTABILITES | Factures"},{created:v(()=>[d(Y,{name:"Nouveau versement",title:r(D)().isUpdate.is?"Modifier le versement":"Nouveau versement"},null,8,["title"]),d(E,{funDelete:r(f),id:r(D)().isDelete.id},null,8,["funDelete","id"]),d(E,{funDelete:r(f),id:r(D)().isDelete.id},null,8,["funDelete","id"])]),_:1}),r(i).length!=0?(A(),h(I,{key:0,dataTables:r(i),MenuActions:r(P),display:r(H)},null,8,["dataTables","MenuActions","display"])):j("",!0),d(B,{loading:r(m).loading,data:r(i),name:"Aucune factures"},null,8,["loading","data"])])]),_:1}))}});export{Z as default};
