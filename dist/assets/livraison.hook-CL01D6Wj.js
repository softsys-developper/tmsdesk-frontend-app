import{m as D,n as _,V as r,l as h,g as E,W as A,X as C,A as c,Y as d,p as S,Z as U}from"./index-2HxWaWMd.js";const I=()=>{const{readData:u,createData:v,deleteData:g,updateData:L}=S(),{EmptyFields:p}=U(),a=D({loading:!1,loadingCreate:!1,loadingDelete:!1,loadingUpdate:!1}),f=_([]);f.value=r().Livraisons;const{toast:o}=h();E().UpdateValue=r().Livraisons[0];const l=i=>i.map(t=>({id:t.id,reference:t.reference,site_livraison:t.site_livraison,date_depart:t.date_depart,date_retour:t.date_retour,status:`<p class="' py-1  capitalize min-w-max rounded-md px-2 flex justify-center font-bold text-xs text-white ' ${t.status!=="en cours"?"bg-green-500":"bg-blue-400"}">${t.status}</p>`,produit_livres:t.produit_livres.length,date_livraison:C(t.created_at).format("l")})),m=A(()=>r().Livraisons);return{FindLivraisonAll:()=>{a.loading=!0,u(c.LIVRAISON_LIST).then(i=>{r().Livraisons=l(i.datas),a.loading=!1}).catch(()=>{a.loading=!1})},FindLivraisonOne:()=>{},CreateLivraison:async i=>(a.loadingCreate=!0,{data:await v(c.LIVRAISON_CREATE,i).then(e=>{if(e){p(i),a.loadingCreate=!1;let s=r().Livraisons;const n=l([e.data]);s.unshift(...n),r().Livraisons=s,d().open=!1,o({title:"Enregistré",description:e.message})}}).catch(e=>{if(a.loadingCreate=!1,e){const s=Object.keys(e.response.data.errors);o(s?{title:s[0],variant:"destructive",description:e.response.data.errors[s[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})}),LivraisonUpdate:(i,t)=>{a.loadingCreate=!0,L(c.USER_UPDATE+"/"+i,t).then(e=>{if(e){p(t),a.loadingCreate=!1;let s=r().Livraisons;const n=l([e.data]);s.unshift(...n),r().Livraisons=s,d().open=!1,o({title:"Enregistré",description:e.message})}}).catch(e=>{if(a.loadingCreate=!1,e){const s=Object.keys(e.response.data.errors);o(s?{title:s[0],variant:"destructive",description:e.response.data.errors[s[0]][0]}:{title:"error",variant:"destructive",description:e.response.data.message})}})},LivraisonDelete:i=>{a.loadingDelete=!0,g(c.USER_REMOVE+"/"+i).then(t=>{if(t){a.loadingDelete=!1;let e=r().Livraisons;const s=e.filter(n=>n.id!=i);e.unshift(...s),r().Livraisons=e,d().open=!1,d().delete=!1,o({title:"Supprimer",description:t.message})}}).catch(t=>{if(a.loadingDelete=!1,d().delete=!1,t){const e=Object.keys(t.response.data.errors);o(e?{title:e[0],variant:"destructive",description:t.response.data.errors[e[0]][0]}:{title:"error",variant:"destructive",description:t.response.data.message})}})},stateLivraisons:f,setLivraison:a,storeLivraisons:m,formatLivraisonData:l}};export{I as u};
